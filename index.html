<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>猜词</title>
    <script src="https://unpkg.com/vue"></script>
    <script src="https://unpkg.com/naive-ui"></script>
</head>
<body>
<div id="app">
    <h1>测试重力</h1>
    <button onclick="requestPermission()">请求重力感应权限</button>
    <p id="orientationOutput">等待设备方向信息...</p>
    <p id="beta"></p>
    <n-button>{{ message }}</n-button>
</div>
<script>
    const App = {
        setup() {
            return {
                message: 'naive'
            }
        }
    }
    const app = Vue.createApp(App);
    app.use(naive);
    app.mount('#app');
</script>

<script>
  function requestPermission() {
    if (typeof DeviceOrientationEvent !== 'undefined' &&
            typeof DeviceOrientationEvent.requestPermission === 'function') {

      DeviceOrientationEvent.requestPermission()
              .then(permissionState => {
                if (permissionState === 'granted') {
                  alert('方向传感器授权成功！');
                } else {
                  document.getElementById('orientationOutput').innerHTML = "授权被拒绝！";
                }
              })
              .catch((err) => {
                console.error("请求权限失败:", err);
              });
    } else {
      console.log('当前设备或浏览器不支持方向传感器 API');
    }
  }

  if (window.DeviceOrientationEvent) {
    window.addEventListener('deviceorientation', function(event) {
      let alpha = event.alpha; // 设备在指南针中的方向，以度为单位，从0到360度。0度指向地理北极。
      let beta = event.beta; // 设备在水平面上的倾斜度，以度为单位。正值表示设备向右上方倾斜，负值表示向左上方倾斜，0表示设备处于水平状态。
      let gamma = event.gamma; // 设备在其自身的轴上的旋转，以度为单位。正值表示设备逆时针旋转，负值表示顺时针旋转，0表示设备未旋转。
        if (beta >= 75 && beta <= 105) {
          document.getElementById('orientationOutput').innerHTML = "设备处于垂直状态（等待）";
        } else if (beta > 105) {
          document.getElementById('orientationOutput').innerHTML = "设备向前翻转（正确）";
        } else if (beta < 75) {
          document.getElementById('orientationOutput').innerHTML = "设备向后翻转（错误）";
        }
      document.getElementById('beta').innerHTML = beta.toFixed(2);
    }, false);
  } else {
    document.getElementById('orientationOutput').innerHTML = "此浏览器不支持Device Orientation API.";
  }
</script>
</body>
</html>